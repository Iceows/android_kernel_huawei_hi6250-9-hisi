#ifndef __RDR_EXCEPTION_PUB_H__
#define __RDR_EXCEPTION_PUB_H__

#define MODULE_MAGIC                0xbaba0514
#define MODULE_VALID                 1
#define MODULE_EXCEPTION_REGISTER_MAXNUM   512
#define RDR_MODULE_NAME_LEN  16
#define RDR_EXCEPTIONDESC_MAXLEN 48

typedef struct excep_time_t {
    u64 tv_sec;
    u64 tv_usec;
}excep_time, rdr_time_st;

struct exc_description_s{
    u32 e_modid;                                                 /* ????id */
    u8 e_process_level;                                        /* ????????????:PROCESS_PRI */
    u8 e_reboot_priority;                                      /* ????????????:REBOOT_PRI */
    u8 e_exce_type;                                             /* ???????? */ 
    u8 e_reentrant;                                              /* ?????????????? */
    u64 e_notify_core_mask;                                /* ???????????? */
    u8 e_desc[RDR_EXCEPTIONDESC_MAXLEN];        /* ???????? */ 
};

struct exc_info_s{
    excep_time e_clock;                                         /* ???????????????? */
    u32 e_excepid;                                               /* ??????????????id */
    u16 e_dump_status;                                        /* ?????????????????????????????????? */
    u16 e_save_status;                                         /* ?????????????????????????????????????? */ 
};

struct exc_module_info_s{
    u32 magic;                                                      /* ??????MODULE_MAGIC */
    u16 e_mod_valid;                                            /* ??????????????????????????1 */
    u16 e_mod_num;                                            /* ???????????????? */
    u8 e_from_module[RDR_MODULE_NAME_LEN];   /* ?????? */
    struct exc_info_s cur_info;                               /* ????dump???????????? */
    u32 e_mini_offset;                                          /* ????????????????????????????????????????????????????magic???? */
    u32 e_mini_len;                                              /* ?????????????????????? */
    u32 e_info_offset;                                          /* ??????????????????????????????????????????????????magic???? */
    u32 e_info_len;                                              /* ???????????????????? */
    struct exc_description_s e_description[1];         /* ???????????????? */
};

enum MODULE_DUMP_STATUS {
    STATUS_INIT = 0,
    STATUS_DOING = 1,
    STATUS_DONE = 2,
};

#endif //__RDR_EXCEPTION_PUB_H__